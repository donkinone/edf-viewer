<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EDF Canvas 拖动功能修复测试</title>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        .test-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .test-section {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .test-title {
            color: #2196F3;
            font-size: 24px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e3f2fd;
            padding-bottom: 10px;
        }
        
        .demo-canvas {
            border: 2px solid #2196F3;
            border-radius: 8px;
            margin: 20px 0;
            background: white;
        }
        
        .status-info {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 12px;
        }
        
        .fix-list {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .fix-list h3 {
            color: #155724;
            margin-bottom: 10px;
        }
        
        .fix-list ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .fix-list li {
            margin: 5px 0;
            color: #155724;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <header>
            <h1>🔧 EDF Canvas 拖动功能修复测试</h1>
            <p class="subtitle">验证修复后的拖动、缩放、重置和滚动条功能</p>
        </header>

        <div class="fix-list">
            <h3>✅ 已修复的问题：</h3>
            <ul>
                <li><strong>拖动平移速度加快</strong>：敏感度从2调整为0.5，拖动更加流畅快速</li>
                <li><strong>滚轮缩放空白修复</strong>：添加智能缩放中心点，以鼠标位置为中心进行缩放</li>
                <li><strong>双击重置空白修复</strong>：确保重置时窗口大小合理，正确计算时间范围</li>
                <li><strong>滚动条跟随修复</strong>：滚动条现在正确反映拖动位置，而不是缩放级别</li>
            </ul>
        </div>

        <div class="test-section">
            <h2 class="test-title">📊 修复验证测试</h2>
            
            <div class="interaction-hints">
                <strong>💡 测试操作指南：</strong>
                <ul>
                    <li><strong>拖动平移测试：</strong>拖动应该比之前更快更流畅</li>
                    <li><strong>滚轮缩放测试：</strong>以鼠标位置为中心缩放，不会出现空白</li>
                    <li><strong>双击重置测试：</strong>双击后应该显示有效数据，不会空白</li>
                    <li><strong>滚动条测试：</strong>拖动时滚动条应该跟随移动，缩放时滚动条大小改变</li>
                </ul>
            </div>

            <div class="eeg-channel-container">
                <div class="eeg-channel-label">测试通道 1</div>
                <canvas id="testCanvas1" class="eeg-channel-canvas demo-canvas" width="1200" height="120"></canvas>
            </div>

            <div class="status-info" id="statusInfo">
                修复测试页面已准备就绪！请在主应用中上传EDF文件来测试修复后的功能。
            </div>
        </div>

        <div class="test-section">
            <h2 class="test-title">🔍 技术细节</h2>
            <div class="status-info">
                <strong>修复详情：</strong><br><br>
                <strong>1. 拖动速度优化：</strong><br>
                - 敏感度从 2 调整为 0.5<br>
                - 数值越小，拖动越快<br><br>
                
                <strong>2. 滚轮缩放修复：</strong><br>
                - 添加鼠标位置检测<br>
                - 以鼠标位置为中心进行缩放<br>
                - 防止缩放后出现空白区域<br><br>
                
                <strong>3. 双击重置修复：</strong><br>
                - 确保最小窗口大小为100个数据点<br>
                - 正确计算结束索引和时间范围<br>
                - 使用dragState中的参数保持一致性<br><br>
                
                <strong>4. 滚动条跟随修复：</strong><br>
                - 修正位置比例计算公式<br>
                - 滚动条位置现在正确反映数据窗口位置<br>
                - 添加边界检查防止越界
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const statusInfo = document.getElementById('statusInfo');
            
            statusInfo.innerHTML = `
                <strong>修复测试页面已准备就绪！</strong><br><br>
                请按以下步骤测试：<br>
                1. 启动后端服务：cd backend && ./start.sh<br>
                2. 访问主应用：http://localhost:3000<br>
                3. 上传EDF文件并测试修复后的功能<br><br>
                <em>所有修复已应用到主应用的script.js文件中</em>
            `;
        });
    </script>
</body>
</html> 